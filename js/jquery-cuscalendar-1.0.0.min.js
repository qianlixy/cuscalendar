/* 自定义平铺式日历插件 v1.0.0*/
!(function(d,e,a){var g={tagName:"span",yearWrap:".year_wrap",monthWrap:".month_wrap",weekWrap:".week_wrap",daysWrap:".day_wrap",prevMonth:".prev",nextMonth:".next",today:".today",presetDate:new Date(),onYearClick:function(h){},onMonthClick:function(h){},onDayClick:function(i,j,h){},onPrevClick:function(h,i){},onNextClick:function(h,i){},onBuildDay:function(i,j,h){}};a.weeks=a.weeks||["周日","周一","周二","周三","周四","周五","周六"];if(!e.CusCalendar){e.CusCalendar=a}function f(k,i,j){var h=parseInt(d().jquery.replace(/\./g,""))||0;if(h<=183){d(k).live(i,j)}else{d(document).on(i,k.selector,j)}}var c=function(){this.array=[];this.appendAll(arguments)};c.prototype.appendAll=function(){for(var l=0;l<arguments.length;l++){var h=arguments[l];if(h.length&&h.length>0){for(var k=0;k<h.length;k++){this.array.push(h[k])}}else{this.array.push(arguments[l])}}};c.prototype.toString=function(){return this.array.join("")};function b(i,k,h){var j=new c("<",i);d.each(h,function(l,m){j.appendAll(" ",l,'="',m,'"')});j.appendAll(">",k||"","</",i,">");return j.toString()}d.fn.cuscal=function(s){var h=d.extend({},g,typeof s==="object"?s:{}),j=new Calendar(h.presetDate),k=arguments;var m={move:function(t,u){j.date.setFullYear(t);j.date.setMonth(u-1);q.call(this)}};return this.each(function(){var v=d(this);if(v.data("cuscal")!==true){n.call(this);f(v.find(h.yearWrap),"click",function(){h.onYearClick.call(this,j.date.getFullYear())});f(v.find(h.monthWrap),"click",function(){h.onMonthClick.call(this,j.date.getMonth()+1)});f(v.find(h.daysWrap+" .day"),"click",function(){var x=d(this),w=j.date.getMonth()+1;if(x.is(".prev_month_day")){w-=1}else{if(x.is(".next_month_day")){w+=1}}h.onDayClick.call(this,x.data("year"),x.data("month"),x.data("day"))});f(v.find(h.prevMonth),"click",function(){var w=j.date.getMonth()+1-1;if(h.onPrevClick.call(this,j.date.getFullYear(),w)!==false){j.moveMonth(w);q.call(v[0])}});f(v.find(h.nextMonth),"click",function(){var w=j.date.getMonth()+1+1;if(h.onNextClick.call(this,j.date.getFullYear(),w)!==false){j.moveMonth(w);q.call(v[0])}});f(v.find(h.today),"click",function(){r.call(v[0])});v.data("cuscal",true)}if(typeof s=="string"&&typeof m[s]=="function"){var t=[];for(var u=0;u<k.length;u++){if(u===0){continue}t.push(k[u])}m[s].apply(this,t)}});function r(){j.date=new Date();q.call(this)}function n(t){var u=d(this);p.call(u.find(h.yearWrap));o.call(u.find(h.monthWrap));if(!t){l.call(u.find(h.weekWrap))}i.call(u.find(h.daysWrap))}function q(){n.call(this,true)}function p(){d(this).attr("data-val",j.date.getFullYear());d(this).html(j.date.getFullYear())}function o(){d(this).attr("data-val",j.date.getMonth()+1);d(this).html(j.date.getMonth()+1)}function l(){var t=d(this);d.each(a.weeks,function(u,v){t.append(b(h.tagName,v,{"class":"week","data-val":u}))})}function i(){var z=d(this),v=[],t=new Date(),A=j.date.getFullYear(),y=j.date.getMonth();z.html("");for(var x=j.howManyDays(1)-1;x>=0;x--){v.push({month:y,day:j.prevMonthDays()-x})}var B=j.monthDays();for(var w=1;w<=B;w++){v.push({month:y+1,day:w})}for(var u=1;u<(7-j.howManyDays(B));u++){v.push({month:y+2,day:u})}d.each(v,function(D,C){var E=["day"];if(C.month===j.date.getMonth()){E.push(" prev_month_day")}else{if(C.month===j.date.getMonth()+1){E.push(" cur_month_day")}else{E.push(" next_month_day")}}if(Calendar.isSameDay(t,A+"-"+C.month+"-"+C.day)){E.push(" cur_day")}var F=d(b(h.tagName,C.day,{"class":E,"data-year":A,"data-month":C.month,"data-day":C.day}));h.onBuildDay.call(F[0],A,C.month,C.day);z.append(F)})}}})(jQuery,window,typeof(CusCalendar)!="undefined"?CusCalendar:{});
